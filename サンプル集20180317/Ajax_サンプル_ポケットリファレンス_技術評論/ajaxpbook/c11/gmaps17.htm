<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
 "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<head><title>Google Maps</title>
<style type="text/css">
v\:* { behavior:url(#default#VML);}
</style>
<script src="http://maps.google.com/maps?file=api&v=2&key=ABQIAAAAAO-r1bqRz2fZr-QmjsewWxTBG40DOe0T0nk6eHQpxKakXljMXBRC2TQok7m4oJbtwLNiVRFOqxftEg" type="text/javascript"></script>
<script type="text/javascript" src="../../lib/funcs.js"></script>
<script type="text/javascript">
//<![CDATA[
function initOnLoad(){
  var map = new GMap2(document.getElementById("map"));
  map.setCenter(new GLatLng(35.6815617, 139.7672091),16);
  //ベースアイコン作成
  var baseIcon = new GIcon();
  baseIcon.shadow = "./shadow2.png";
  baseIcon.iconSize = new GSize(24, 30);
  baseIcon.iconAnchor = new GPoint(12,37);
  baseIcon.shadowSize = new GSize(37, 37);
  baseIcon.infoWindowAnchor = new GPoint(12, 15);
  baseIcon.infoShadowAnchor  = new GPoint(37, 25);
  iconName = ['a','b','c','d','e','f','g','h'];
  //アイコンとクリックイベント生成
  function createIcon(point, index) {
  	var msg    = iconName[index].toUpperCase() + " がクリックされました。";
  	var icon   = new GIcon(baseIcon);
  	icon.image = "./"+ iconName[index] +".png";
  	var marker = new GMarker(point,{icon:icon});
  	var html = "<div>マーカー<b>" + msg + "</b></div>";
  	GEvent.addListener(marker, "click", function() {
  		marker.openInfoWindowHtml(html);
  	});
  	return marker;
  }
  //地図上にランダムなアイコンをiconNameの数だけ追加
  var bounds = map.getBounds();
  var height = bounds.getNorthEast().lat() - bounds.getSouthWest().lat();
  var width = bounds.getNorthEast().lng() - bounds.getSouthWest().lng();
  for (var i = 0; i < iconName.length ; i++) {
  	var point = new GLatLng(bounds.getSouthWest().lat() + height * Math.random(),
  	bounds.getSouthWest().lng() + width * Math.random());
  	var marker = createIcon(point, i);
  	map.addOverlay(marker);
  }
}
setListener(window, "load", initOnLoad);
//]]>
</script>
</head>
<body>
<div id="map" style="width: 500px; height: 400px"></div>
</body>
</html>

